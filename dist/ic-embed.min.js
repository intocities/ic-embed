!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).IC=e()}}((function(){var e=function(){function e(e,t,i){this.id=e,this.key=t,this.baseUrl=i}return Object.defineProperty(e.prototype,"cdnUrl",{get:function(){return"https://cdn.intocities.com"},enumerable:!1,configurable:!0}),e.prototype.iframeUrl=function(){return"".concat(this.baseUrl,"/embed/").concat(this.id.toString(),"/").concat(this.key)},e}(),t={};function i(e){var t=e.href,i=e.rel,n=e.type,o=e.as,r=document.createElement("link");r.href=t,r.rel=i,n&&(r.type=n),o&&(r.as=o),document.head.appendChild(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.batchAddLinksToHead=t.assignStyles=void 0,t.assignStyles=function(e,t){Object.keys(t).forEach((function(i){e.style.setProperty(i,t[i])}))},t.batchAddLinksToHead=function(e){e.forEach((function(e){i(e)}))};var n={width:"100%",height:"100%",border:"none",overflow:"hidden"},o=function(){function e(e){var t,i=this;if(!e||!(null===(t=null==e?void 0:e.contentWindow)||void 0===t?void 0:t.postMessage))throw new TypeError("Parameter must be a HTMLIFrameElement!");var n={iframe:e,iframeOrigin:e.src.split("/").slice(0,3).join("/")};this.options=n,console.log("ICEmbed initialized with options",this.options),window.addEventListener("message",(function(e){i.receiveMessage(e)}),!1)}return e.init=function(i,o,r){var s=document.createElement("iframe");return s.id="ic-tour-".concat(o.id),s.src=o.iframeUrl(),s.allowFullscreen=!0,s.allow="fullscreen",t.assignStyles(s,n),i.replaceWith(s),new e(s)},e.prototype.assertAllowedOrigin=function(e){if(e!==this.options.iframeOrigin)throw new Error("Discarding incoming message; untrusted event origin.")},e.prototype.dispatchEvent=function(e,t){console.log("dispatchEvent",e,t),this.options.iframe.dispatchEvent(new window.CustomEvent(e,{detail:t}))},e.prototype.receiveMessage=function(e){console.log("receiveMessage",e),this.assertAllowedOrigin(e.origin),this.dispatchEvent(e.data.name,e.data)},e.prototype.postMessage=function(e){console.log("postMessage",e,this.options.iframeOrigin),this.options.iframe.contentWindow.postMessage(e,this.options.iframeOrigin)},e.prototype.params=function(){var e=this.options.iframe.src.split("#");if(1===e.length)return{};for(var t=e[1].split("&"),i={},n=0;n<t.length;n++){var o=t[n].split("="),r=decodeURIComponent(o[0]),s=decodeURIComponent(o[1]);i[r]=s}return i},e.prototype.changeScene=function(e,t,i){if("string"==typeof t)t=parseFloat(t);else if("number"!=typeof t)throw new TypeError("ath must be number or string");if("string"==typeof i)i=parseFloat(i);else if("number"!=typeof i)throw new TypeError("atv must be number or string");var n={name:"changeScene",sceneId:e,ath:t,atv:i};this.postMessage(n)},e}(),r={position:"relative",width:"100%",height:"100%",overflow:"hidden"},s={position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},a={width:"100%",height:"100%","object-fit":"cover","z-index":"1"},d={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"2","border-radius":"0.5em"},c=function(){function e(e,t,i){var n=this;this.container=e,this.apiCredentials=t,this.buttonText=i,this.preload(),this.container.addEventListener("click",(function(e){o.init(n.container,n.apiCredentials,n.buttonText)}))}return e.prototype.add=function(){t.assignStyles(this.container,r);var e=document.createElement("div");t.assignStyles(e,s);var i=document.createElement("img");i.loading="lazy",i.src=this.imageUrl,t.assignStyles(i,a);var n=document.createElement("button");n.innerText=this.buttonText,t.assignStyles(n,d),e.appendChild(n),e.appendChild(i),this.container.appendChild(e)},e.prototype.preload=function(){t.batchAddLinksToHead([{rel:"preconnect",href:this.apiCredentials.baseUrl},{rel:"dns-prefetch",href:this.apiCredentials.cdnUrl},{rel:"preload",href:this.imageUrl,as:"image"}])},Object.defineProperty(e.prototype,"imageUrl",{get:function(){return"".concat(this.apiCredentials.baseUrl,"/images/").concat(this.apiCredentials.id,"/tour-preview.jpg")},enumerable:!1,configurable:!0}),e}(),l={};return Object.defineProperty(l,"__esModule",{value:!0}),l.preview=l.embed=void 0,l.embed=function(e){return new o(e)},l.preview=function(t,i,n,o,r){void 0===o&&(o="https://intocities.com"),void 0===r&&(r="Start Virtual Tour"),new c(t,new e(i,n,o),r).add()},l}));